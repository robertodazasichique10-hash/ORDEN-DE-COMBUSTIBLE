<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>SISTEMA MAGP - 08D01 ESMERALDAS</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root { --azul: #003366; --oro: #b45309; --gris: #f1f5f9; --verde: #10b981; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--gris); margin: 0; padding: 10px; }
        .login-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background: var(--azul); display: flex; align-items: center; justify-content: center; z-index: 1000; }
        .card-login { background: white; padding: 30px; border-radius: 10px; text-align: center; box-shadow: 0 10px 25px rgba(0,0,0,0.3); width: 320px; }
        .card { max-width: 850px; margin: 10px auto; background: white; padding: 30px; border-radius: 8px; border-top: 15px solid var(--azul); box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { color: var(--azul); font-size: 18px; margin: 0; text-align: center; text-transform: uppercase; }
        h2 { font-size: 13px; text-align: center; color: #444; margin: 5px 0 15px 0; border-bottom: 2px solid var(--oro); padding-bottom: 8px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 10px; }
        label { display: block; font-weight: bold; margin-bottom: 3px; color: #333; font-size: 11px; }
        input, textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 12px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th { background: var(--azul); color: white; padding: 8px; font-size: 11px; border: 1px solid #ddd; }
        td { border: 1px solid #ddd; padding: 6px; text-align: center; font-size: 12px; }
        .total-box { background: #fef3c7; font-weight: bold; font-size: 16px; color: #92400e; padding: 10px; border-radius: 5px; text-align: right; margin-top: 10px; border: 1px solid var(--oro); }
        canvas { border: 1px solid #bbb; background: #fff; width: 100%; height: 100px; touch-action: none; }
        .hidden { display: none; }
        .btn { background: var(--azul); color: white; padding: 12px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; width: 100%; }
        .firma-input { border: none; border-bottom: 1px solid #000; text-align: center; font-weight: bold; width: 90%; margin-top: 5px; background: transparent; font-size: 11px; }
    </style>
</head>
<body>

    <div id="login-screen" class="login-overlay">
        <div class="card-login">
            <img src="https://upload.wikimedia.org/wikipedia/commons/2/27/Logo_MAG.png" alt="MAG" style="width: 120px; margin-bottom: 10px;">
            <h3 style="color: var(--azul); font-size: 16px;">ORDEN DE COMBUSTIBLE<br>DISTRITAL 08D01</h3>
            <input type="text" id="user-ced" placeholder="Cédula" style="margin-bottom: 10px; text-align: center;">
            <input type="password" id="user-pass" placeholder="Clave (su cédula)" style="margin-bottom: 15px; text-align: center;">
            <button class="btn" onclick="validar()">INGRESAR</button>
        </div>
    </div>

    <div id="main-app" class="hidden">
        <div class="card" id="pdf-area">
            <h1>Dirección Distrital 08D01 Esmeraldas - MAGP</h1>
            <h2>Orden de Despacho de Combustible</h2>

            <div class="grid">
                <div><label>Fecha:</label><input type="date" id="f-fecha"></div>
                <div><label>Salvoconducto:</label><input type="text" placeholder="Ej: 08D01-2026-001"></div>
            </div>

            <div class="grid">
                <div><label>Conductor:</label><input type="text" id="f-conductor" readonly style="background:#f9f9f9;"></div>
                <div><label>Placa/Vehículo:</label><input type="text" placeholder="PEA-1234"></div>
            </div>

            <table>
                <thead><tr><th>Tipo de Producto</th><th>Galones</th><th>P. Unitario</th><th>Total</th></tr></thead>
                <tbody>
                    <tr><td style="text-align:left;">EXTRA / ECOPAÍS</td><td><input type="number" id="g1" oninput="calc()" step="0.01"></td><td>2.40</td><td id="t1">0.00</td></tr>
                    <tr><td style="text-align:left;">DIESEL PREMIUM</td><td><input type="number" id="g2" oninput="calc()" step="0.01"></td><td>1.75</td><td id="t2">0.00</td></tr>
                </tbody>
            </table>

            <div class="total-box">VALOR TOTAL: $<span id="total">0.00</span></div>

            <div class="grid" style="margin-top: 30px;">
                <div style="text-align:center;">
                    <canvas id="c1"></canvas>
                    <input type="text" id="nom-cond" class="firma-input" readonly>
                    <div style="font-size: 9px; font-weight: bold;">CONDUCTOR RESPONSABLE</div>
                </div>
                <div style="text-align:center;">
                    <canvas id="c2"></canvas>
                    <input type="text" class="firma-input" value="Mgs. Gina Solís">
                    <input type="text" value="RESPONSABLE DE TRANSPORTES" style="border:none; text-align:center; width:95%; font-size:9px;">
                    <div style="font-size: 9px; font-weight: bold;">AUTORIZADO POR</div>
                </div>
            </div>
        </div>
        <div style="text-align: center; margin-top:10px;">
            <button class="btn" style="background:var(--verde); width:280px;" onclick="generarPDF()">DESCARGAR ORDEN</button>
            <p><button onclick="location.reload()" style="border:none; background:none; color:red; cursor:pointer; font-size:11px;">Cerrar Sesión</button></p>
        </div>
    </div>

    <script>
        const DATA = [
            {c:"0801550096", n:"ROBERTO ANTONIO DAZA SICHIQUE"}, {c:"0801671090", n:"CHICA VALENCIA AMABLE ANTONIO"},
            {c:"1311423683", n:"MARCILLO OCHOA EDUARDO JAVIER"}, {c:"0801587890", n:"VALVERDE SANCHEZ CARLOS EDUARDO"},
            {c:"0802872598", n:"ESPINOZA LOZA LENNY PRISCILA"}, {c:"0802440495", n:"CEDEÑO REQUENE CARMEN ISABEL"},
            {c:"0914087879", n:"BAZAN PRECIADO JECICA ELENA"}, {c:"0800899536", n:"VALENCIA CAICEDO COLON FRANCISCO"},
            {c:"1304230343", n:"RIVERA ESCOBEDO ARTURO JOHNNY"}, {c:"0801666371", n:"PADILLA CHUQUIMARCA MARTHA ESTRELLA"},
            {c:"0802320606", n:"CAMPOS OBANDO FLOR MARIA"}, {c:"0802159962", n:"ESTUPIÑAN DIAZ NELSON PAUL"},
            {c:"0802259416", n:"QUIÑONEZ CUERO JENIFER NATALIA"}, {c:"0801461740", n:"FONSECA PINARGOTE GARY LOBERTTY"},
            {c:"0802860221", n:"QUIÑONEZ GONZALEZ JENNY ELIZABETH"}, {c:"0801968538", n:"OREJUELA MONTAÑO FREDDY ENRIQUE"},
            {c:"0801633538", n:"VALENCIA VALENCIA GABRIEL EFREN"}, {c:"0803130129", n:"GUERRERO CABEZA MARCO ANTONIO"},
            {c:"0801655614", n:"MERO PACHAY JOSE BENITO"}, {c:"0801488735", n:"MONTAÑO VALENCIA DAVID ALFREDO"},
            {c:"0801449075", n:"CAICEDO QUINTERO CARLOS ALBERTO"}, {c:"0801890116", n:"MORALES MEZA FRANKLIN ADRIANO"},
            {c:"1310188980", n:"ZAMBRANO INTRIAGO RICARDO ANTONIO"}, {c:"0802874255", n:"BONILLA VALENCIA GINA VANESSA"},
            {c:"0802377885", n:"CEDEÑO QUIÑONEZ KATHERINE MERCEDES"}, {c:"0801648056", n:"ORTIZ MALDONADO JOSE ANTONIO"},
            {c:"0802804534", n:"BONILLA BONILLA KAREN LILIANA"}, {c:"1312389149", n:"ZAMBRANO MERA CARLOS ERNESTO"},
            {c:"1313437566", n:"VILLAMAR REINA MAURO GABRIEL"}, {c:"0802288078", n:"ESTUPIÑAN VALENCIA ADRIANA DEL PILAR"},
            {c:"0801705625", n:"VERA FLORES LUIS ALBERTO"}, {c:"0801738733", n:"BAUTISTA ALAVA RAMIRO ESTEBAN"},
            {c:"0801657875", n:"LOOR ALCIVAR VICENTE ARMANDO"}, {c:"0802613200", n:"ZAMBRANO COIME JUAN JOSE"},
            {c:"0803378521", n:"QUIÑONEZ VALENCIA ESTRELLA ELIZABETH"}, {c:"0802213702", n:"PAREDES CHALEN CARMEN VICTORIA"},
            {c:"0802206672", n:"ANGULO RODRIGUEZ NANCY EDITH"}, {c:"0802315726", n:"REASCO ARROYO JORGE WASHINGTON"},
            {c:"0802273615", n:"CABEZAS QUIÑONEZ ALEXANDRA MARISOL"}, {c:"1306915032", n:"MACIAS MARCILLO LUIS ALBERTO"},
            {c:"1713020921", n:"SANCHEZ MORENO LUIS MIGUEL"}, {c:"1313264952", n:"REYES VERA JENNIFER KATIUSKA"},
            {c:"1312384728", n:"PINARGOTE BERMELLO MIGUEL ANGEL"}, {c:"1722880158", n:"TUMIPAMBA AGUINDA ANDREA ELIZABETH"},
            {c:"0802956276", n:"GUERRERO MONTAÑO MANUEL MESIAS"}, {c:"0803028292", n:"RODRIGUEZ ANGULO MIRIAM RAQUEL"},
            {c:"0802909473", n:"ANGULO BONILLA MANUEL ALEJANDRO"}, {c:"0803407940", n:"OREJUELA CASTILLO JESSICA LORENA"},
            {c:"1315682896", n:"MERA SANTANA DARLING XAVIER"}, {c:"0802422774", n:"BASTIDAS CHILA ROBERTO MARCELO"},
            {c:"1313247064", n:"ZAMBRANO RIVADENEIRA LUBER JAVIER"}, {c:"0803038622", n:"ORTIZ SOLIS MARCOS VINICIO"},
            {c:"0804470384", n:"TIXE LLUMIGUANO ADRIANA GABRIELA"}, {c:"1311059537", n:"MERA SANTANA DARWIN JOSE"},
            {c:"1314539659", n:"ZAMBRANO CEDEÑO JOSE EDUARDO"}, {c:"1311540304", n:"VELIZ MACIAS ENRIQUE RODRIGO"},
            {c:"1311542383", n:"CEVALLOS PONCE ALBA TATIANA"}, {c:"1311520629", n:"PINARGOTE BERMELLO ERICK PAUL"},
            {c:"1309836375", n:"MENDOZA MENDOZA JUAN IGNACIO"}, {c:"0803080640", n:"ROBALINO CASTILLO JOSE LUIS"},
            {c:"1314138098", n:"REYES VERA CINTHYA DAYANA"}, {c:"0803123892", n:"SALAZAR MARCILLO CRISTHIAN ROBERTO"},
            {c:"1313175133", n:"ESPINALES POSLIGUA ANDY ALFREDO"}, {c:"1311756538", n:"HIDROVO MORA VICTOR ANDRES"},
            {c:"1311559908", n:"SANTANA VERA FRANKLIN MARCELO"}, {c:"1315276335", n:"LOOR ALCIVAR VICENTE MARCELO"},
            {c:"1311504995", n:"VILLAMAR REINA MAURO ANDRES"}, {c:"1311504110", n:"MERO PACHAY JOSE ANTONIO"},
            {c:"1311100521", n:"BAUTISTA ALAVA RAMIRO XAVIER"}, {c:"0802195040", n:"VERA FLORES LUIS ERNESTO"},
            {c:"0802958330", n:"ANGULO RODRIGUEZ NANCY ELIZABETH"}, {c:"0802772129", n:"RAMIREZ TIMARAN DIANA JOANNA"},
            {c:"1311542516", n:"TIPAN ALCIVAR LUIS ALBERTO"}, {c:"0801611880", n:"ANDRADE PEREA LUIS ENRIQUE"},
            {c:"0803150259", n:"CAMACHO TELLO KAREN INDIRA"}, {c:"0802132696", n:"HIDALGO VERA ANGEL KLEBER"},
            {c:"1206243782", n:"JIMENEZ GUERRERO JEFFERSON FABRICIO"}, {c:"0803805613", n:"PRADO BONE YILIO ALBERTO"},
            {c:"0802679654", n:"VIVAR SOSA EDDY DANIEL"}, {c:"1313572313", n:"GARCIA ARTEAGA RODRIGO ANDRES"},
            {c:"1311660714", n:"BRIONES ALAVA CESAR OSWALDO"}, {c:"0801883026", n:"BARREZUETA MALDONADO ALEXIS ALBERTO"},
            {c:"1712295904", n:"LOOR DAVILA DANILO ANDRE"}, {c:"1726634544", n:"ARIAS SALAMEA ADRIAN ALEJANDRO"},
            {c:"0803129865", n:"TREJO MONTAÑO ERICK ADRIAN"}
        ];

        function validar() {
            let ced = document.getElementById('user-ced').value.trim();
            let pas = document.getElementById('user-pass').value.trim();
            if (ced.length === 9) ced = "0" + ced;
            const u = DATA.find(x => x.c === ced && (pas === x.c || pas === 'admin'));
            if (u) {
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('main-app').classList.remove('hidden');
                document.getElementById('f-conductor').value = u.n;
                document.getElementById('nom-cond').value = u.n;
                document.getElementById('f-fecha').valueAsDate = new Date();
                setupF('c1'); setupF('c2');
            } else { alert("Cédula o clave incorrecta"); }
        }

        function calc() {
            const v1 = (parseFloat(document.getElementById('g1').value)||0) * 2.40;
            const v2 = (parseFloat(document.getElementById('g2').value)||0) * 1.75;
            document.getElementById('t1').innerText = v1.toFixed(2);
            document.getElementById('t2').innerText = v2.toFixed(2);
            document.getElementById('total').innerText = (v1+v2).toFixed(2);
        }

        function setupF(id) {
            const can = document.getElementById(id); const ctx = can.getContext('2d'); let d = false;
            const p = (e) => { const r = can.getBoundingClientRect(); return { x: (e.clientX || e.touches[0].clientX) - r.left, y: (e.clientY || e.touches[0].clientY) - r.top }; };
            can.onmousedown = (e) => { d = true; ctx.beginPath(); const pos = p(e); ctx.moveTo(pos.x, pos.y); };
            can.onmousemove = (e) => { if(d) { const pos = p(e); ctx.lineTo(pos.x, pos.y); ctx.stroke(); } };
            window.onmouseup = () => d = false;
            can.ontouchstart = (e) => { d = true; ctx.beginPath(); const pos = p(e); ctx.moveTo(pos.x, pos.y); e.preventDefault(); };
            can.ontouchmove = (e) => { if(d) { const pos = p(e); ctx.lineTo(pos.x, pos.y); ctx.stroke(); e.preventDefault(); } };
        }

        function generarPDF() {
            const element = document.getElementById('pdf-area');
            html2pdf().set({ margin: 0.5, filename: 'Orden_MAG_08D01.pdf', html2canvas: { scale: 3 }, jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' } }).from(element).save();
        }
    </script>
</body>
</html>
